User
è¿™ç¯‡æ–‡ç« çš„spectral softcap , hard cap, hammer, normalizeå„è‡ªéƒ½æ˜¯ä»€ä¹ˆï¼Ÿç»“åˆæ•°å­¦ç»™å‡ºç›´è§‚è§£é‡Šï¼Œå¹¶ä¸”æœ€å¥½èƒ½å¼•ç”¨Githubé‡Œä»–çš„å„è‡ªæºä»£ç ã€‚å‹æƒ…æç¤ºï¼Œå…¶å®ç›¸å…³ä»£ç åœ¨nanogpt/train_spectral_normalize.pyé‡Œé¢ã€‚æ­¤å¤–ï¼Œè¿™ç¯‡æ–‡ç« çš„lipschitzä¸Šç•Œæ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„ï¼Ÿæˆ‘è®°å¾—è®ºæ–‡é™„å½•æœ€åæ˜¯æœ‰è¿™éƒ¨åˆ†çš„ï¼Œä½†æ˜¯æ²¡çœ‹æ‡‚ï¼Œç»™å‡ºä¸€æ­¥æ­¥çš„æ¨å¯¼

GPT-5
å¥½çš„ï¼Œè¿™å‡ æ‹›åˆ†åˆ«åœ¨å¹²å•¥ã€æ€ä¹ˆåšã€ä»£ç å“ªå„¿ã€æ•°å­¦ä¸Šç›´è§‰å•¥æ ·ï¼Œæˆ‘ç»™ä½ ä¸€å£æ°”è®²æ¸…æ¥šï¼ˆé¡ºæ‰‹æŠŠè®ºæ–‡é‡Œ Lipschitz ä¸Šç•Œçš„æ¨åˆ°ä¹Ÿèµ°ä¸€éï¼‰ã€‚TL;DRï¼šå®ƒä»¬éƒ½æ˜¯â€œæŠŠçŸ©é˜µå¾€è°±èŒƒæ•°çƒé¢/çƒå†…æŒ‰ä½â€çš„ä¸åŒæ‰‹æ®µï¼ŒåŒºåˆ«åªåœ¨äºâ€œæ€ä¹ˆæŒ‰â€â€œæŒ‰å¤šç‹ â€â€œç®—åŠ›èŠ±å“ªå„¿â€ã€‚

# å››ä¸ªæ“ä½œå„è‡ªæ˜¯ä»€ä¹ˆï¼Ÿ

## 1) spectral **normalize**ï¼ˆè°±å½’ä¸€åŒ–ï¼‰

\*\*åšä»€ä¹ˆï¼š\*\*æŠŠæ¯ä¸ªæƒé‡çŸ©é˜µ $W$ é™¤ä»¥å®ƒçš„æœ€å¤§å¥‡å¼‚å€¼ $\sigma_{\max}(W)$ï¼ˆå¿…è¦æ—¶å†ä¹˜ä¸ªç›®æ ‡åŠå¾„ $w_{\max}$ï¼‰ï¼Œä½¿ $\|W\|_2\le w_{\max}$ï¼Œå…¸å‹æ˜¯ç›´æ¥æŠ•å½±åˆ°â€œè°±èŒƒæ•°çƒé¢/çƒå†…â€ã€‚
\*\*è®¡ç®—æ³•ï¼š\*\*ç”¨ power iteration è¿‘ä¼¼ $\sigma_{\max}$ï¼Œç„¶å $W \leftarrow W \cdot \min\!\big(1,\frac{w_{\max}}{\hat\sigma}\big)$ã€‚è®­ç»ƒè„šæœ¬é‡Œæœ‰è‡ªå†™çš„ power iterationï¼ˆ26ï½32 æ­¥ï¼‰ï¼š`_power_iteration(M)`ï¼Œç”¨éšæœºå‘é‡å¾ªç¯ $u\!\mapsto\!Mu\!\mapsto\!M^\top u$ å½’ä¸€åŒ–æ”¶æ•›åˆ°ä¸»å¥‡å¼‚å‘é‡ï¼Œå†è¯» $\|u^\top M\|$ å½“ $\hat\sigma$ã€‚è¿™æ®µå°±åœ¨ `nanogpt/train_spectral_normalize.py` é‡Œï¼ˆå‡½æ•° `_power_iteration`ï¼‰ã€‚([GitHub][1])
**ä½•æ—¶æ–½åŠ ï¼š**æŒ‰ä½œè€…å®ç°ï¼Œæ˜¯**æ¯ä¸ªä¼˜åŒ–å™¨ step ä¹‹åã€ä¸‹ä¸€æ¬¡å‰å‘å‰**å¯¹æƒé‡åšæŠ•å½±ï¼ˆREADME é‡ŒæŠŠè¿™ä¸€æ­¥ç”»åœ¨â€œ2) project weightsâ€¦â€ï¼‰ã€‚([GitHub][2])

## 2) spectral **softcap**ï¼ˆè°±è½¯å¸½ï¼‰

**åšä»€ä¹ˆï¼š**ä¸æ˜¯â€œç¡¬åˆ‡åˆ°é˜ˆå€¼â€ï¼Œè€Œæ˜¯ç”¨**å¤šé¡¹å¼**æŠŠå¥‡å¼‚å€¼æœ $\min(\sigma,w_{\max})$ è¿ç»­åœ°æ¨è¿‡å»ã€‚ç›´è§‰åƒâ€œæ©¡çš®é”¤è½»æ•²â€ï¼Œè¿‡å¤§çš„å¥‡å¼‚å€¼è¢«æŸ”å’Œå‹ä½ï¼Œå°çš„å‡ ä¹ä¸åŠ¨ã€‚
**è®¡ç®—æ³•ï¼š**ä½œè€…å®ç°äº†ä¸€ä¸ªéå¸¸çŸ­çš„äºŒæ®µå¤šé¡¹å¼åºåˆ—ï¼Œå¯¹çŸ©é˜µåå¤åš $M\leftarrow aM+b(MM^\top)M$ çš„å˜æ¢ï¼Œç­‰ä»·äºå¯¹å…¨éƒ¨å¥‡å¼‚å€¼**å¹¶è¡Œ**æ–½åŠ ä¸€ä¸ªè¿‘ä¼¼ $\min(1,x)$ çš„å¤šé¡¹å¼ï¼ˆæŠŠ $x$ çœ‹ä½œå¥‡å¼‚å€¼/é˜ˆå€¼æ¯”ï¼‰ã€‚ä»£ç åœ¨ `soft_cap(M, alpha)`ï¼Œä¸¤æ­¥ç³»æ•°æ˜¯ `[(1,-alpha),(1,alpha)]`ï¼ˆå¯å †å /æ‰¹å¤„ç†ï¼‰ï¼Œè§ `train_spectral_normalize.py`ã€‚([GitHub][1])
**è‡ªé€‚åº”å¼ºåº¦ï¼ˆå¾ˆå…³é”®ï¼‰ï¼š**æ–‡ä»¶é‡Œè¿˜æœ‰ `soft_cap_coupling(w_max, wd, max_update_norm)`ï¼Œå®ƒæŠŠ**æƒé‡è¡°å‡** `wd`ã€**Muon æ›´æ–°çš„æœ€å¤§è°±èŒƒæ•°** `max_update_norm` å’Œä½ è®¾å®šçš„ $w_{\max}$ ä»£è¿›å»ï¼Œè§£ä¸€ä¸ªä¼´éšçŸ©é˜µçš„ç‰¹å¾å€¼é—®é¢˜ï¼Œæ±‚å‡ºâ€œæœ€å°éè´Ÿå®æ ¹â€ä½œä¸º softcap çš„åŠ›åº¦ $\alpha$ã€‚è¿™ä¿è¯â€œ**æ›´æ–°+æƒé‡è¡°å‡+è½¯å¸½**â€çš„ç»„åˆ**ä¸æŠŠå¥‡å¼‚å€¼æ‰“å‡ºç•Œ**ã€‚å°±æ˜¯é‚£æ®µæŠŠç³»æ•°å¡è¿› companion matrix å† `eigvals` çš„ä»£ç ã€‚([GitHub][1])

## 3) spectral **hard cap**ï¼ˆè°±ç¡¬å¸½ï¼‰

**åšä»€ä¹ˆï¼š**æŠŠæ¯ä¸ªå¥‡å¼‚å€¼**ç²¾ç¡®**åœ°æ˜ åˆ° $\min(\sigma,w_{\max})$ã€‚
\*\*è®¡ç®—æ³•ï¼ˆç›´è§‚+å…¬å¼ï¼‰ï¼š\*\*Laker çš„æ–‡ç« ç»™äº†æ¼‚äº®çš„æ ‡é‡æ’ç­‰å¼

$$
\min(1,x)=\tfrac12\Big((1+x)\,\mathrm{sign}(1+x)-(1-x)\,\mathrm{sign}(1-x)\Big),\quad x\ge 0,
$$

æŠŠ $\mathrm{sign}$ æ¨åˆ°â€œçŸ©é˜µç¬¦å·å‡½æ•°/çŸ©é˜µæ­£äº¤åŒ–â€ä¸Šï¼ˆç”¨ $f(W)=UV^\top$ï¼Œ$W=U\Sigma V^\top$ï¼‰ï¼Œå¾—åˆ°**çŸ©é˜µç‰ˆ**çš„è°±å¸½ï¼š

$$
\mathrm{spectral\_cap}(W;\beta)=\tfrac12\!\left(\beta f(W)+W\;-\;f\!\big(\beta I-f(W)W^\top\big)\big(\beta f(W)-W\big)\right),
$$

å…¶æ•ˆæœå°±æ˜¯æŠŠæ‰€æœ‰å¥‡å¼‚å€¼é€åˆ° $\min(\beta,\sigma)$ï¼ˆè®ºæ–‡é™„å½• B æç¤ºï¼‰ã€‚åšæ–‡é‡Œç›´æ¥ç»™äº†è¿™æ¡å¼å­ä¸å›¾ç¤ºã€‚([Laker Newhouse][3])
**å®ç°å¤‡æ³¨ï¼š**ä»“åº“ README è¯´ä»–ä»¬**æ—©æœŸ**çš„ hard cap ç”¨çš„æ˜¯ä¸€å¥—å¤šé¡¹å¼è¿‘ä¼¼ç³»æ•°ï¼Œåæ¥ Leloy Kun / è‹å‰‘æ—ç»™å‡ºäº†å¸¦ *msign* çš„â€œæ›´ç²¾ç¡®â€å…¬å¼ï¼›repo ç›®å‰ä¿ç•™æ—§ç³»æ•°ä¾¿äºå¤ç°å®éªŒã€‚([GitHub][2])

## 4) spectral **hammer**ï¼ˆè°±é“é”¤ï¼‰

**åšä»€ä¹ˆï¼š**æ¯æ­¥ç”¨ power iteration åª**æŠ“æœ€å¤§çš„**å¥‡å¼‚å€¼/å¥‡å¼‚å‘é‡å¯¹ï¼Œç„¶åæŠŠå®ƒ**ç›´æ¥æ•²åˆ°é˜ˆå€¼**ï¼ˆè®¾æˆ 1 æˆ– $w_{\max}$ï¼‰ã€‚
**ç›´è§‰ï¼š**â€œåªç›¯ç¬¬ä¸€åâ€ï¼Œå› æ­¤å¾ˆçœï¼›å¯¹ Adam è¿™ç§ä½ç¨³å®šç§©æ›´æ–°ç»å¸¸å¤Ÿç”¨ï¼Œä½†ä¸ä¿è¯æ¬¡å¤§ã€æ¬¡æ¬¡å¤§å¥‡å¼‚å€¼ä¹Ÿåœ¨ç•Œå†…ã€‚Laker åœ¨ Muon-3 çš„åšæ–‡é‡Œä¸“é—¨å†™äº†è¿™ä¸€æ‹›ã€‚([Laker Newhouse][3])
\*\*ä»£ç è”ç³»ï¼š\*\*è®­ç»ƒè„šæœ¬é‡Œå·²æœ‰ power iterationï¼Œhammer å°±æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šâ€œå®šç‚¹ç¼©æ”¾â€é‚£ä¸€ä¸‹ï¼ˆåŒä¸Š `_power_iteration`ï¼‰ã€‚([GitHub][1])

> å°ç»“ï¼š**normalize**=æŠ•å½±/ç¼©æ”¾ï¼›**softcap**=å…‰æ»‘æ”¶ç´§ï¼ˆå…¨è°±ã€ä½æŠ–åŠ¨ï¼‰ï¼›**hard cap**=ç²¾ç¡®æˆªæ–­ï¼ˆæ›´ç¡¬æ ¸ã€ç®—åŠ›æ›´è´µ/éœ€çŸ©é˜µç¬¦å·ï¼‰ï¼›**hammer**=åªé”¤æœ€å¤§å¥‡å¼‚å€¼ï¼ˆä¾¿å®œã€ä½†ä¸æ§å…¨è°±ï¼‰ã€‚

# å®ƒä»¬æ˜¯åœ¨å‰å‘è¿˜æ˜¯åå‘çº¦æŸï¼Ÿ

åœ¨ä½œè€…çš„è®­ç»ƒæµç¨‹é‡Œï¼Œè¿™æ˜¯**æƒé‡å±‚é¢çš„æŠ•å½±/å˜æ¢**ï¼šæ¯ä¸ªä¼˜åŒ–å™¨æ­¥ä¹‹åï¼ŒæŠŠæƒé‡é‡æ–°**æŠ•åˆ°è°±èŒƒæ•°çƒå†…/çƒé¢**ï¼Œç„¶åå†åšä¸‹ä¸€æ¬¡**å‰å‘**ã€‚ä¸æ˜¯åœ¨åä¼ é‡Œæ”¹æ¢¯åº¦ï¼ˆé‚£æ˜¯ Muon çš„å·¥ä½œï¼‰ï¼Œè€Œæ˜¯**æ›´æ–°åç«‹åˆ»â€œä¿®çŸ©é˜µâ€**ã€‚README çš„æ–¹æ³•å›¾è§£ä¹Ÿæ˜¯â€œ(1) Muon çº¦æŸæ›´æ–°ï¼›(2) æŠ•å½±æƒé‡åˆ°æœ€å¤§å¥‡å¼‚å€¼é˜ˆï¼›(3) å¾—åˆ° Lipschitz ä¿è¯â€ã€‚([GitHub][2])

---

# è®ºæ–‡é‡Œçš„ Lipschitz ä¸Šç•Œæ€ä¹ˆæ¥ï¼Ÿï¼ˆæŒ‰æ¨¡å—â†’æ•´ç½‘ï¼Œé€æ­¥æ­å‡ºæ¥ï¼‰

**åŸºæœ¬è§„åˆ™ï¼ˆä»»ä½•ç½‘ç»œéƒ½ç”¨ï¼‰ï¼š**

* çº¿æ€§å±‚ $x\mapsto Wx$ çš„ $L_2$-Lipschitz å¸¸æ•°å°±æ˜¯ $\|W\|_2=\sigma_{\max}(W)$ã€‚
* ç»„åˆ $f\circ g$ çš„ä¸Šç•Œæ˜¯å¸¸æ•°ç›¸ä¹˜ã€‚
* æ®‹å·® $x\mapsto x+g(x)$ çš„ä¸Šç•Œæ˜¯ $1+L(g)$ã€‚
* å…ƒç´ çº§æ¿€æ´»å¦‚æœæ˜¯ 1-Lipschitzï¼ˆReLUã€tanh çš„æ–œç‡â‰¤1 éƒ¨åˆ†ç­‰ï¼‰ï¼Œå°±ä¸æ”¾å¤§ã€‚
  è¿™äº›åŸåˆ™è´¯ç©¿è®ºæ–‡çš„â€œè¯ä¹¦å¼â€ä¼°è®¡ï¼šåªè¦**ä¿è¯æ¯å±‚ $\|W\|_2\le w_{\max}$**ï¼Œå…¨ç½‘ä¸Šç•Œå°±èƒ½ä¹˜/åŠ æ‹¼èµ·æ¥ï¼ˆè®ºæ–‡æ‘˜è¦å’Œæ–¹æ³•éƒ¨åˆ†çš„ç²¾ç¥å°±æ˜¯â€œæŠŠæƒé‡æ¨åœ¨/æ¨è¿›çƒé‡Œï¼Œç„¶åä¹˜èµ·æ¥ç»™è¯ä¹¦â€ï¼‰ã€‚([arXiv][4])

**æ³¨æ„ï¼šä»–ä»¬è¿˜è®­ç»ƒäº†**æ—  LayerNormã€æ—  QK normã€æ—  logit tanh softcap\*\* çš„å˜ä½“\*\*ï¼Œå› æ­¤ä¸Šç•Œæ¨å¯¼ä¸»è¦æ¥è‡ª**çº¿æ€§å— + æ®‹å·®**ä¸**æ³¨æ„åŠ›**ã€‚([arXiv][4])

## (A) MLP å­å±‚

ä¸¤å±‚æ„ŸçŸ¥æœºï¼ˆæ— æ¿€æ´»æ”¾å¤§ï¼‰

$$
\text{MLP}(x)=x+W_2\phi(W_1 x) \quad\Rightarrow\quad
L_{\text{MLP}}\le 1+\|W_2\|_2\,\|W_1\|_2.
$$

è‹¥éƒ½å¼ºåˆ¶ $\le w_{\max}$ï¼Œåˆ™ $L_{\text{MLP}}\le 1+w_{\max}^2$ã€‚

## (B) å¤šå¤´æ³¨æ„åŠ› MSA å­å±‚ï¼ˆä¸åš LN çš„ç‰ˆæœ¬ï¼‰

æŠŠæ³¨æ„åŠ›è§†ä¸º $x\!\mapsto\!W_O\;\mathrm{Attn}(Q,K,V)$ ä¸” $Q=xW_Q, K=xW_K, V=xW_V$ã€‚å¯¹ softmax ä¸ç¼©æ”¾/æ©ç ç”¨ä¸€ä¸ªä¿å®ˆå¸¸æ•° $c_{\mathrm{attn}}$ï¼ˆè®ºæ–‡é™„å½•ç»™å‡ºè¯¥å¸¸æ•°çš„å…·ä½“æ¨æ³•ï¼›ç›´è§‰æ¥æºäº softmax é›…å¯æ¯”çš„è°±èŒƒæ•°ä¸Šç•Œä¸ $\frac{1}{\sqrt{d}}$ ç¼©æ”¾ï¼‰ã€‚åˆ™

$$
L_{\text{MSA}}\;\le\;1+\|W_O\|_2\cdot c_{\mathrm{attn}}\cdot \|W_V\|_2\cdot \|W_Q\|_2\cdot \|W_K\|_2.
$$

è‹¥å¼ºåˆ¶æ¯ä¸ªçŸ©é˜µ $\le w_{\max}$ï¼Œå°±å¾—åˆ°

$$
L_{\text{MSA}}\le 1+c_{\mathrm{attn}}\;w_{\max}^4.
$$

ï¼ˆå¤šå¤´æŠŠå‡ è·¯æ‹¼å›è¾“å‡ºï¼Œä¿å®ˆåšæ³•æ˜¯æŠŠå¸¸æ•°å¸è¿› $c_{\mathrm{attn}}$ã€‚ï¼‰

## (C) å•ä¸ª Transformer block

$$
L_{\text{block}}\;\le\;L_{\text{MSA}}\cdot L_{\text{MLP}}
\;\le\; \big(1+c_{\mathrm{attn}}w_{\max}^4\big)\big(1+w_{\max}^2\big).
$$

## (D) å †å  $L$ å±‚

$$
L_{\text{net}}\;\le\;\prod_{\ell=1}^{L}
\big(1+c_{\mathrm{attn}}^{(\ell)}w_{\max}^4\big)\big(1+w_{\max}^2\big).
$$

å¦‚æœæ‰€æœ‰å±‚ç»Ÿä¸€çº¦æŸå¹¶ç”¨ç›¸åŒå¸¸æ•°ï¼Œä¸Šå¼å°±æ˜¯ä¸Šç•Œè¯ä¹¦ã€‚è®ºæ–‡é‡ŒæŠ¥å‘Šäº†ï¼šå½“æŠŠè¯ä¹¦å‹åˆ° $10$ é‡çº§æ—¶è¿˜èƒ½è·‘å‡º 21% çš„ FineWeb å‡†ç¡®ç‡ï¼›è¦è¿½å¹³åŸºçº¿ 39.4% åˆ™è¯ä¹¦æš´æ¶¨åˆ° $10^{264}$ï¼ˆå¯è§â€œè¯ä¹¦â€å¾ˆä¿å®ˆä½†**å¯æ§**ï¼‰â€”â€”è¿™æ®µå®šé‡ç»“æœåœ¨æ‘˜è¦é‡Œã€‚([arXiv][4])

> ä½ å¯ä»¥æŠŠè¿™æ•´å¥—çœ‹æˆâ€œ**ç”¨ Muon å›ºå®šæ›´æ–°èŒƒæ•°** + **æŠŠæƒé‡æ°¸è¿œé’‰åœ¨è°±çƒé‡Œ** â†’ **å±‚å±‚ä¹˜å‡ºä¸€ä¸ªæ˜¾å¼ä¸Šç•Œ**â€ã€‚softcap é‡Œçš„ `soft_cap_coupling` æ­£æ˜¯ä¸ºè¿™æ¡é“¾è¡¥ä¸Šâ€œæ›´æ–°é‚£ä¸€æ­¥åˆ«æŠŠä½ é¡¶å‡ºçƒâ€çš„æ‹¼å›¾ã€‚([GitHub][1])

---

# ä»£ç å‹˜ä½ï¼ˆä½ é—®åˆ°çš„ `nanogpt/train_spectral_normalize.py`ï¼‰

* **power iterationï¼ˆç»™ normalize / hammer ç”¨ï¼‰ï¼š**`_power_iteration(M)`ï¼ˆ26 æ¬¡è¿­ä»£ï¼Œä¼° $\sigma_{\max}$ï¼‰ã€‚([GitHub][1])
* **softcap ä¸»ä½“ï¼š**`soft_cap(M, alpha)` ä¸¤æ­¥ $M\leftarrow aM+b(MM^\top)M$ çš„å¥‡å¼‚å€¼å¤šé¡¹å¼æ¨è¿›ï¼›æ”¯æŒæ‰¹å¤„ç†ï¼Œè‡ªåŠ¨åšè½¬ç½®ä»¥ç”¨åˆ° $MM^\top$ã€‚([GitHub][1])
* **softcap-å¼ºåº¦è”åŠ¨ï¼š**`soft_cap_coupling(w_max, wd, max_update_norm)` ç”¨ä¼´éšçŸ©é˜µç‰¹å¾å€¼é€‰**æœ€å°éè´Ÿå®æ ¹**æ±‚ $\alpha$ï¼ŒæŠŠ `wd` ä¸ Muon çš„æœ€å¤§æ›´æ–°èŒƒæ•°ä¸²èµ·æ¥ã€‚([GitHub][1])
* \*\*ï¼ˆhard cap æ³¨è®°ï¼‰ï¼š\*\*README é‡Œè¯´æ˜ç¡¬å¸½ç”¨çš„å¤šé¡¹å¼ç³»æ•°æ˜¯æ—©æœŸç‰ˆæœ¬ï¼›åæ¥ Leloy/è‹å‰‘æ—ç»™äº† *msign* çš„æ›´å‡†åšæ³•ï¼Œå€¼å¾—ä½ åœ¨æ­¤ä»“é‡Œå°è¯•æ›¿æ¢ã€‚([GitHub][2])
* \*\*Muon & æ­£äº¤åŒ–ï¼š\*\*åŒæ–‡ä»¶é‡Œæœ‰ Newtonâ€“Schulz çš„æ­£äº¤åŒ–ï¼ˆ`zeropower_via_newtonschulz5` / `orthogonalize`ï¼‰ï¼Œè¿™æ˜¯ Muon çš„â€œæŠŠæ›´æ–°å˜æˆè¿‘ä¼¼æ­£äº¤çŸ©é˜µâ€çš„æ ¸å¿ƒç§¯æœ¨ï¼Œä¹Ÿè¢«è°±å¸½å…¬å¼ï¼ˆ$f(W)=UV^\top$ï¼‰æ‰€åˆ©ç”¨ã€‚([GitHub][1])

---

# ä¼˜ç¼ºç‚¹ä¸€é¡µå›¾ï¼ˆè¨€ç®€æ„èµ…ç‰ˆï¼‰

* **normalize**ï¼šæœ€ç®€å•ã€ç¨³å®šï¼›ä½†æ¯æ­¥éƒ½è¦ä¼° $\sigma_{\max}$ å¹¶æ•´ä½“ç¼©æ”¾ï¼Œå¯èƒ½â€œæŠŠå…¨è°±éƒ½æ‹‰ç˜¦â€ã€‚ï¼ˆå®ç°ä¸ GAN çš„ SN ä¸€è„‰ç›¸æ‰¿ã€‚ï¼‰([arXiv][4])
* **softcap**ï¼šå¯å¾®/å¹³æ»‘ï¼Œå¯¹å¤§å¥‡å¼‚å€¼æ›´â€œæ¸©æŸ”â€ï¼Œå’Œ Muon çš„â€œå›ºå®šæ›´æ–°èŒƒæ•°â€èƒ½**è”åŠ¨**ï¼ˆä¸Šé¢çš„ couplingï¼‰ï¼›ä½†éœ€è¦è‹¥å¹²æ¬¡çŸ©é˜µä¹˜ã€‚([GitHub][1])
* **hard cap**ï¼šç†è®ºæœ€å¹²è„†ï¼ˆç²¾ç¡® $\min(\sigma,w_{\max})$ï¼‰ï¼Œç”¨ *msign* æˆ–é«˜é˜¶å¤šé¡¹å¼è¿‘ä¼¼ï¼›ä»£ä»·æ¯” softcap å¤§ã€æ•°å€¼ä¸Šæ›´æŒ‘å‰”ã€‚([Laker Newhouse][3])
* **hammer**ï¼šè¶…ä¾¿å®œã€å¯¹ Adam å¸¸å¥½ç”¨ï¼Œä½†åªæ§ $\sigma_{\max}$ï¼Œå¯¹æ¬¡å¤§å¥‡å¼‚å€¼æ²¡ä¿è¯ï¼›åšâ€œè¯ä¹¦â€æ—¶ä¿å®ˆå¸¸æ•°å¾—æŒ‰çƒæ¥ç®—ã€‚([Laker Newhouse][3])

---

# å‚è€ƒä¸å»¶ä¼¸

* è®ºæ–‡ä¸»é¡µ/æ‘˜è¦ï¼ˆç»™æ•´ä½“æ–¹æ³•ä¸è¯ä¹¦èƒŒæ™¯ï¼‰ï¼šNewhouse et al., *Training Transformers with Enforced Lipschitz Constants*ï¼ˆarXiv:2507.13338ï¼Œ2025-07-17 æäº¤ï¼‰ã€‚([arXiv][4])
* åšæ–‡ï¼ˆæŠŠ **hard cap** çš„çŸ©é˜µå…¬å¼ã€**hammer** çš„ç›´è§‰éƒ½ç”»å‡ºæ¥äº†ï¼‰ï¼šLaker Newhouse, *Understanding Muon â€” Chapter 3: Weight Regulation*. ([Laker Newhouse][3])
* ä»£ç ä»“åº“ï¼ˆREADME æœ‰ hard cap å…¬å¼æ²¿é©ï¼›è®­ç»ƒè„šæœ¬é‡Œæœ‰ **softcap / coupling / power iteration**ï¼‰ï¼š`Arongil/lipschitz-transformers`. ([GitHub][2])

---

å¦‚æœä½ æƒ³**åŠ¨æ‰‹æ”¹**ï¼šå»ºè®®å…ˆæŠŠä»“åº“é‡Œ hard cap çš„æ—©æœŸå¤šé¡¹å¼æ›¿æ¢æˆ Leloy/è‹å‰‘æ—çš„ *msign* ç‰ˆæœ¬ï¼ˆREADME é‡Œå°±ç‚¹åäº†ï¼‰ï¼Œè½¯ç¡¬åˆ‡æ¢åšä¸ª flagï¼Œå†æŠŠ `soft_cap_coupling` é‚£å¥—æ ¹æ±‚è§£ä¹Ÿæ¥åˆ° hard cap ä¸Šï¼Œè¿™æ ·å°±èƒ½â€œä¸€é”®é€‰æ‹©ï¼šè½¯/ç¡¬/é”¤/å½’ä¸€åŒ–â€ï¼ŒåŒæ—¶ä¿æŒ Muon-coupling çš„ä¸å‡ºç•Œä¿è¯ã€‚æœªæ¥å¯ç©ï¼šæŠŠ $w_{\max}$ åšæˆ**åˆ†å±‚/åˆ†å¤´è‡ªé€‚åº”**ï¼ˆæ¯”å¦‚æŒ‰æ³¨æ„åŠ› logit æˆ–æ¿€æ´»ç»Ÿè®¡åŠ¨æ€è°ƒï¼‰ï¼ŒæŠŠâ€œè¯ä¹¦ä¸å‡†ç¡®ç‡â€ä» 10â†”39% é‚£æ¡æ›²çº¿å¾€å³ä¸Šè§’æ¨ä¸€æ¨ã€‚ğŸ˜

[1]: https://github.com/Arongil/lipschitz-transformers/raw/main/nanogpt/train_spectral_normalize.py "raw.githubusercontent.com"
[2]: https://github.com/Arongil/lipschitz-transformers "GitHub - Arongil/lipschitz-transformers: Don't just regulate gradients like in Muon, regulate the weights too"
[3]: https://www.lakernewhouse.com/writing/muon-3 "Understanding Muon"
[4]: https://arxiv.org/abs/2507.13338 "[2507.13338] Training Transformers with Enforced Lipschitz Constants"
